<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Vault ‚Äî Notes & Drive</title>
  <meta name="description" content="Secure personal vault for notes and file storage by Dhruv Shah">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)">
  <div id="loader">
    <div class="spin"></div><span
      style="font-size:.7rem;color:var(--text3);letter-spacing:1.5px;font-weight:500">PERSONAL VAULT</span>
  </div>
  <div id="toast"><i id="t-icon" class="ri-information-line"></i><span id="t-msg"></span></div>

  <!-- AUTH -->
  <div id="auth-screen">
    <div class="auth-card">
      <div class="auth-brand">Personal Vault</div>
      <div class="auth-sub">by Dhruv Shah</div>
      <div class="field"><input type="email" id="email" placeholder="Email address"></div>
      <div class="field"><input type="password" id="pass" placeholder="Password"
          onkeydown="if(event.key==='Enter')login()"></div>
      <button id="lbtn" class="btn-main" onclick="login()">Sign In</button>
      <p id="aerr" class="auth-err"></p>
    </div>
  </div>

  <!-- APP -->
  <div id="app">
    <nav id="sidebar">
      <div class="s-brand"><i class="ri-shield-keyhole-fill"></i>Personal Vault</div>
      <div class="s-label">Workspace</div>
      <div class="s-item active" data-v="drive" onclick="go('drive')"><i class="ri-hard-drive-2-line"></i>Drive</div>
      <div class="s-item" data-v="notes" onclick="go('notes')"><i class="ri-file-text-line"></i>Notes</div>
      <div class="s-label">Tools</div>
      <div class="s-item" onclick="openGrammar()"><i class="ri-quill-pen-line"></i>Grammar Check</div>
      <div class="s-item" data-v="trash" onclick="go('trash')"><i class="ri-delete-bin-5-line"></i>Trash<span
          class="cnt hidden" id="tcnt">0</span></div>
      <div class="s-foot">
        <div class="s-toggle" onclick="toggleTheme()"><i id="thIcon" class="ri-sun-line"></i><span id="thLabel">Light
            Mode</span></div>
        <div class="s-user">
          <div class="s-av" id="uav">D</div>
          <div style="overflow:hidden;flex:1">
            <div class="s-email" id="uemail">user</div>
          </div>
          <button class="s-out" onclick="logout()" title="Sign out"><i class="ri-logout-box-r-line"></i></button>
        </div>
      </div>
    </nav>

    <main id="main">

      <!-- DRIVE VIEW -->
      <div id="view-drive" style="display:flex;flex-direction:column;height:100%">
        <div class="topbar">
          <div class="tb-left"><i class="ri-home-5-fill" onclick="curPath='/';refreshDrive()"></i><span>/</span><span
              class="path" id="dpath">Home</span></div>
          <div class="tb-right">
            <div class="vbtns"><button class="active" onclick="setView('grid',this)"><i
                  class="ri-layout-grid-fill"></i></button><button onclick="setView('list',this)"><i
                  class="ri-list-check"></i></button></div>
            <select class="sel" onchange="sortBy=this.value;refreshDrive()">
              <option value="name">Sort: Name</option>
              <option value="date">Sort: Date</option>
              <option value="size">Sort: Size</option>
            </select>
            <div class="ib" onclick="createFolder()"><i class="ri-folder-add-line"></i><span>Folder</span></div>
            <div class="ib filled" onclick="document.getElementById('fup').click()"><i
                class="ri-upload-2-line"></i><span>Upload</span></div>
            <input type="file" id="fup" hidden multiple onchange="uploadFiles(this.files)">
          </div>
        </div>
        <div class="drive-content">
          <div id="dgrid" class="grid"></div>
          <div class="drop-overlay"><i class="ri-upload-cloud-2-line" style="font-size:2rem;margin-right:10px"></i>Drop
            files to upload</div>
        </div>
      </div>

      <!-- NOTES VIEW -->
      <div id="view-notes" class="hidden">
        <div class="note-sidebar">
          <div class="ns-head">
            <div class="ns-top">
              <h3>üìù Notes</h3>
              <div class="ib filled" onclick="createNote()" style="font-size:.8rem"><i
                  class="ri-add-line"></i><span>New</span></div>
            </div>
            <input class="ns-search" placeholder="Search notes..." oninput="filterNotes(this.value)">
          </div>
          <div class="ftabs" id="ftabs"></div>
          <div id="nlist"></div>
        </div>
        <div class="editor" id="editor">
          <div id="lockwall" class="lock-wall hidden"><i class="ri-lock-2-fill"></i>
            <h2>This note is locked</h2>
            <input type="password" id="lockpw" placeholder="Enter password"
              style="padding:9px 14px;background:var(--surface2);border:1.5px solid var(--border);border-radius:var(--r);color:var(--text);width:200px;text-align:center;outline:none;margin-top:4px;font-size:.85rem">
            <button class="btn-main" style="width:200px;margin-top:6px" onclick="unlockNote()">Unlock</button>
          </div>
          <div id="no-note" class="no-note"><i class="ri-file-text-line"></i>
            <p>Select a note or create a new one<br><span style="font-size:.75rem">Click <b>+ New</b> to get
                started</span></p>
          </div>
          <div id="editor-ui" class="hidden" style="display:flex;flex-direction:column;flex:1">
            <div class="e-bar">
              <button class="tbtn" onclick="insertMD('**')" title="Bold"><i class="ri-bold"></i></button>
              <button class="tbtn" onclick="insertMD('*')" title="Italic"><i class="ri-italic"></i></button>
              <button class="tbtn" onclick="insertMD('`')" title="Code"><i class="ri-code-s-slash-line"></i></button>
              <button class="tbtn" onclick="insertMD('~~')" title="Strikethrough"><i
                  class="ri-strikethrough"></i></button>
              <div class="tsep"></div>
              <button class="tbtn" onclick="toggleFocus()" title="Focus Mode"><i class="ri-focus-3-line"></i></button>
              <button class="tbtn" id="lockbtn" onclick="toggleLock()" title="Lock note"><i
                  class="ri-lock-unlock-line"></i></button>
              <div class="e-info"><span id="wc">0 words</span><span id="ss"><span class="save-dot"></span>Saved</span>
              </div>
            </div>
            <input id="ntitle" placeholder="Note title..." oninput="triggerSave()">
            <textarea id="nbody" placeholder="Start writing your thoughts..." oninput="handleInput(this)"></textarea>
          </div>
        </div>
      </div>

      <!-- TRASH VIEW -->
      <div id="view-trash" class="hidden" style="display:flex;flex-direction:column;height:100%">
        <div class="topbar">
          <div class="tb-left"><i class="ri-delete-bin-5-line"></i><span class="path">Trash</span></div>
          <div class="tb-right">
            <div class="ib" onclick="emptyTrash()" style="color:var(--danger)"><i
                class="ri-delete-bin-fill"></i><span>Empty</span></div>
          </div>
        </div>
        <div class="trash-area" id="tlist"></div>
      </div>

    </main>
  </div>

  <div id="ctx" class="ctx hidden"></div>
  <script src="app.js"></script>
</body>

</html>